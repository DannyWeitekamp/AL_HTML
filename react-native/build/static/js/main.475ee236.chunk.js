(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){e.exports=n.p+"static/media/Arrowhead-01-128.3fbf838f.png"},101:function(e,t,n){e.exports=n.p+"static/media/Arrowhead-Down-01-128.912d4e8d.png"},113:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(31),l=n.n(o),s=(n(99),n(54)),i=n(70),c=n(32),d=n(33),u=n(40),_=n(34),h=n(47),p=n(41),m=n(92),b=n(88),f=n(20),y=n(90),g=n(120),C=n(9),E=n(119),k=n(91),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(_.a)(t).call(this,e))).icons={up:n(100),down:n(101)},a.state={title:e.title,expanded:!1,expandable:!0,animation:new E.a.Value(e.collapsedHeight)},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"_setMaxHeight",value:function(e){this.setState({maxHeight:e.nativeEvent.layout.height,expandable:e.nativeEvent.layout.height>this.props.collapsedHeight})}},{key:"_setMinHeight",value:function(e){this.setState({minHeight:e.nativeEvent.layout.height})}},{key:"toggle",value:function(){var e=Math.max(this.state.maxHeight+this.state.minHeight,this.props.collapsedHeight),t=Math.max(this.state.minHeight,this.props.collapsedHeight),n=this.state.expanded?e:t,a=this.state.expanded?t:e;this.setState({expanded:!this.state.expanded}),this.state.animation.setValue(n),E.a.timing(this.state.animation,{toValue:a,duration:50}).start()}},{key:"render",value:function(){var e=this.icons.down;return this.state.expanded&&(e=this.icons.up),r.a.createElement(E.a.View,{style:[w.container,{height:this.state.animation}]},r.a.createElement(g.a,{underlayColor:"#f1f1f1",onLayout:this._setMinHeight.bind(this),onPress:this.state.expandable?this.toggle.bind(this):null},r.a.createElement(f.a,{style:w.titleContainer},r.a.createElement(b.a,{style:w.title}," ",this.props.title," "),this.state.expandable&&r.a.createElement(k.a,{style:w.buttonImage,source:e}))),r.a.createElement(f.a,{style:w.body,onLayout:this._setMaxHeight.bind(this)},this.props.children))}}]),t}(a.Component),w=C.a.create({container:{backgroundColor:"#fff",margin:2,overflow:"hidden"},titleContainer:{flexDirection:"row"},title:{flex:1,padding:2,color:"#2a2f43",fontWeight:"bold"},button:{},buttonImage:{width:30,height:25},body:{padding:5,paddingTop:0,paddingBottom:20}}),x=S;function v(e,t,n){return e=[e],t.forEach(function(t,a){e=e.map(function(e,o){if("string"==typeof e){var l=e.split(t);if(l.length>1)return s=l,i=r.a.createElement(b.a,{style:{color:n[a],textShadowRadius:3,textShadowColor:n[a]}},t),Object(m.a)(s).map(function(e,t){return t<s.length-1?[e,i]:[e]}).reduce(function(e,t){return e.concat(t)})}var s,i;return e}).flat()}),e}var O={ButtonPressed:function(e,t){return"Press Button"},UpdateTextField:function(e,t){return e.name||e.how}},D={UpdateTextField:function(e,t){var n=e.mapping["?sel"],a=Object.entries(e.mapping).reduce(function(e,t){return"?sel"!==t[0]&&e.push(t[1]),e},[]);n=n.replace("?ele-","");var r="("+(a=a.map(function(e){return e.replace("?ele-","")})).join(", ")+"): "+n+"->"+(e.inputs&&e.inputs.value);return r=v(r,[n].concat(a),t)},ButtonPressed:function(e,t){return"Press: "+e.mapping["?sel"].replace("?ele-","")}},F=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(u.a)(this,Object(_.a)(t).call(this,e))).s_skill_set=n.structure_skills(e.skill_set);var a=n.starting_selection();return n.state={selected_skill:a,selected_match:a,correctness_map:{}},n.handleClickSkillItem=n.handleClickSkillItem.bind(Object(h.a)(n)),n.handleClickCorrectnessButton=n.handleClickCorrectnessButton.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"starting_selection",value:function(){if("first"==this.props.initial_select){var e=Object.keys(this.s_skill_set)[0];return null==e?null:this.s_skill_set[e][0]}}},{key:"structure_skills",value:function(e){var t={},n=0,a=function(){var a={};for(o in e[r])(l=e[r][o]).how in a||(a[l.how]=l,a[l.how].matches=[]),l._id=n++,a[l.how].matches.push(l),t[r]=Object.keys(a).map(function(e,t){return a[e]})};for(var r in e){var o,l;a()}return t}},{key:"selectSkill",value:function(e,t){t||(t=e),this.setState({selected_skill:e,selected_match:t})}},{key:"daisyChain",value:function(e,t,n){return function(a){e(a,t,n)}}},{key:"handleClickSkillItem",value:function(e,t,n){var a=Object(i.a)(t,2),r=a[0],o=a[1];this.selectSkill(r,o),console.log(this.props.select_callback),this.props.select_callback&&this.props.select_callback(o||r),n&&n(t)}},{key:"handleClickCorrectnessButton",value:function(e,t){var n=Object(i.a)(t,3),a=n[0],r=n[1],o=n[2],l=r._id,c=this.state.correctness_map[l]&&o===this.state.correctness_map[l]?null:o,d=Object(s.a)({},this.state.correctness_map);null===c?delete d[l]:d[l]=c;var u=0===Object.keys(this.state.correctness_map).length,_=0===Object.keys(d).length;!u&&_?(console.log("EMPTY"),this.props.service.send("SKILL_PANEL_FEEDBACK_EMPTY")):u&&!_&&(console.log("NOT EMPTY"),this.props.service.send("SKILL_PANEL_FEEDBACK_NONEMPTY")),this.setState({correctness_map:d}),console.log(d),this.props.correctness_callback&&this.props.correctness_callback(r||a,c)}},{key:"componentWillReceiveProps",value:function(e){this.s_skill_set=this.structure_skills(e.skill_set);var t=Object.keys(this.s_skill_set);if(!this.state.selected_skill&&t.length>0){var n=this.s_skill_set[t[0]][0];this.setState({selected_skill:n,selected_match:n,match_correctness:{}})}}},{key:"render",value:function(){var e=this;return r.a.createElement(f.a,{style:P.content},r.a.createElement(f.a,{style:A.skill_list},r.a.createElement(y.a,null,Object.keys(this.s_skill_set).map(function(t,n){var a=r.a.createElement(g.a,{underlayColor:"#fff"},r.a.createElement(b.a,{style:A.sectionHeader},t)),o=e.s_skill_set[t].map(function(t,n){var a=e.state.selected_skill&&e.state.selected_skill._id===t._id,o=(O[t.action]||O.UpdateTextField)(t,e.props.where_colors),l=r.a.createElement(g.a,{underlayColor:"#f1f1f1",onPress:e.daisyChain(e.handleClickSkillItem,[t],t.callback)},r.a.createElement(b.a,{style:[A.item,a&&A.selected_skill],backgroundColor:"#ff00ffff"},o)),s=[];return"matches"in t&&(s=t.matches.map(function(n,o){if("mapping"in n){var l=e.state.selected_match&&e.state.selected_match._id===n._id,s=(D[n.action]||D.UpdateTextField)(n,e.props.where_colors),i="correct"===e.state.correctness_map[n._id],c="incorrect"===e.state.correctness_map[n._id];return r.a.createElement(f.a,{style:A.match_container},r.a.createElement(g.a,{underlayColor:"#919191",onPress:e.daisyChain(e.handleClickCorrectnessButton,[t,n,"correct"])},r.a.createElement(b.a,{style:[A.correctness_button,i&&A.correct_selected]},String.fromCharCode(10004))),r.a.createElement(g.a,{underlayColor:"#919191",onPress:e.daisyChain(e.handleClickCorrectnessButton,[t,n,"incorrect"])},r.a.createElement(b.a,{style:[A.correctness_button,c&&A.incorrect_selected]},String.fromCharCode(10006))),r.a.createElement(g.a,{underlayColor:"#919191",style:{flex:1},onPress:e.daisyChain(e.handleClickSkillItem,[t,n],n.callback)},r.a.createElement(b.a,{style:[A.match,a&&l&&A.selected_match]},s)))}return null})),s=s.filter(function(e){return null!=e}),[l].concat(s)});return[a].concat(o)}))),r.a.createElement(y.a,{style:A.skill_info,showsVerticalScrollIndicator:!0},r.a.createElement(x,{title:"How",collapsedHeight:this.props.collapsedHeight.how},r.a.createElement(b.a,null,this.state.selected_skill&&this.state.selected_skill.how)),r.a.createElement(x,{title:"Where",collapsedHeight:this.props.collapsedHeight.where},r.a.createElement(b.a,null,this.state.selected_skill&&JSON.stringify(this.state.selected_skill.where,null,2))),r.a.createElement(x,{title:"When",collapsedHeight:this.props.collapsedHeight.when},r.a.createElement(b.a,null,this.state.selected_skill&&this.state.selected_skill.when)),r.a.createElement(x,{title:"Which",collapsedHeight:this.props.collapsedHeight.which},r.a.createElement(b.a,null,this.state.selected_skill&&this.state.selected_skill.which))))}}]),t}(a.Component),P=C.a.create({content:{display:"flex",height:"100%",flexDirection:"row",backgroundColor:"#F5FCFF",width:"100%",borderRadius:4,borderWidth:.5,borderColor:"#d6d7da"}}),A=C.a.create({skill_list:{flexBasis:250,paddingTop:10},skill_info:{flex:1,paddingTop:10},sectionHeader:{flexWrap:"wrap",paddingTop:6,paddingLeft:10,paddingRight:10,paddingBottom:2,fontSize:15,fontWeight:"bold",backgroundColor:"'rgba(247,247,247,1.0)'"},selected_skill:{backgroundColor:"#93e4ec"},item:{flexWrap:"wrap",padding:4,paddingLeft:6,fontSize:16,borderBottomWidth:1,borderColor:"gray",backgroundColor:"'rgba(247,0,0,0.0)'"},correctness_button:{fontSize:20,width:27,textAlign:"center",borderWidth:.1,borderColor:"lightgray"},incorrect_selected:{backgroundColor:"red"},correct_selected:{backgroundColor:"limegreen"},match_container:{display:"flex",flexDirection:"row",borderBottomWidth:1,borderColor:"gray"},match:{flex:1,flexWrap:"wrap",justifySelf:"stretch",padding:3,textIndent:5,fontSize:15,backgroundColor:"'rgba(252,252,252,1.0)'"},selected_match:{backgroundColor:"#b3e8ff"}});F.defaultProps={collapsedHeight:{how:40,where:90,when:90,which:40},where_colors:["darkorchid","#ff884d","#52d0e0","#feb201","#e44161","#ed3eea","#2f85ee","#562ac6","#cc24cc"],select_callback:function(){}};var N=F,T=n(46),j=["Or specify if the ",r.a.createElement(b.a,{style:{color:"darkorchid",textShadowRadius:3,textShadowColor:"darkorchid"}},"highlighted")," input is correct for the next step."],I=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(_.a)(t).call(this,e))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.current;console.log(t);var n=function(e){return t.matches?t.matches(e):"Specify_Start_State"==e},a=function(t){console.log(t),console.log(e.props.callbacks),e.props.callbacks&&t in e.props.callbacks&&e.props.callbacks[t](),e.props.service.send(t)};return r.a.createElement(f.a,{style:L.container},r.a.createElement(f.a,{style:L.button_wrapper1},r.a.createElement(b.a,{style:L.prompt1},n("Specify_Start_State")&&"Set the start state.",n("Query_Demonstrate")&&"Demonstrate the next step.",n("Explantions_Displayed")&&"Press next to continue. Or demonstrate the next step.",n("Request_Foci")&&"Select any interface elements that were used to compute this result."),n("Request_Foci")&&r.a.createElement(g.a,{style:L.next_button,underlayColor:"#CCCCCC",onPress:function(){return a("FOCI_DONE")}},r.a.createElement(b.a,{style:L.next_button_text},"Next")),n("Explantions_Displayed")&&r.a.createElement(g.a,{style:L.next_button,underlayColor:"#CCCCCC",onPress:function(){return a("NEXT_PRESSED")}},r.a.createElement(b.a,{style:L.next_button_text},"Next")),n("Specify_Start_State")&&r.a.createElement(g.a,{style:L.startstate_button,underlayColor:"#CCCCCC",onPress:function(){return a("START_STATE_SET")}},r.a.createElement(b.a,{style:L.startstate_button_text},"Start State Done"))),(n({Query_Demonstrate:"Query_Yes_No_Feedback"})||n({Query_Demonstrate:"Query_Submit_Feedback"}))&&r.a.createElement(f.a,{style:L.button_wrapper2},r.a.createElement(b.a,{style:L.prompt2},n({Query_Demonstrate:"Query_Yes_No_Feedback"})&&j,n({Query_Demonstrate:"Query_Submit_Feedback"})&&"Or press submit to send the feedback from the skill panel."),n({Query_Demonstrate:"Query_Yes_No_Feedback"})&&r.a.createElement(f.a,{style:L.yes_no},r.a.createElement(g.a,{style:L.yes_button,underlayColor:"#CCCCCC",onPress:function(){return a("YES_PRESSED")}},r.a.createElement(b.a,{style:L.yes_button_text},"YES")),r.a.createElement(g.a,{style:L.no_button,underlayColor:"#CCCCCC",onPress:function(){return a("NO_PRESSED")}},r.a.createElement(b.a,{style:L.no_button_text},"NO"))),n({Query_Demonstrate:"Query_Submit_Feedback"})&&r.a.createElement(g.a,{style:L.submit_button,underlayColor:"#CCCCCC",onPress:function(){return a("SUBMIT_SKILL_FEEDBACK")}},r.a.createElement(b.a,{style:L.submit_button_text},"Submit"))),!this.props.debugmode&&r.a.createElement(f.a,{style:L.button_wrapper3},r.a.createElement(g.a,{style:L.nools_button,underlayColor:"#CCCCCC",onPress:this.props.nools_callback},r.a.createElement(b.a,{style:L.nools_button_text},"Generate Nools"))),this.props.debugmode&&r.a.createElement(f.a,{style:L.button_wrapper3},r.a.createElement(f.a,{style:{display:"absolute",bottom:0,flexDirection:"row"}},r.a.createElement(g.a,{style:[L.yes_button,{height:20}],underlayColor:"#CCCCCC",onPress:function(){return a("DEMONSTRATE")}},r.a.createElement(b.a,{style:{fontSize:10}},"Demonstrate")),r.a.createElement(g.a,Object(T.a)({style:[L.yes_button,{height:20}],underlayColor:"#CCCCCC",onPress:function(){}},"onPress",function(){return a("DONE")}),r.a.createElement(b.a,{style:{fontSize:10}},"Done")),r.a.createElement(g.a,Object(T.a)({style:[L.yes_button,{height:20}],underlayColor:"#CCCCCC",onPress:function(){}},"onPress",function(){return a("APPLICABLE_SKILLS_RECIEVED")}),r.a.createElement(b.a,{style:{fontSize:10}},"Req recieved")))))}}]),t}(a.Component),L=C.a.create({container:{display:"flex",height:"100%"},prompt1:{fontSize:20,textAlign:"center",margin:5},prompt2:{fontSize:20,textAlign:"center",margin:5},button_wrapper1:{display:"flex",flexDirection:"column",alignItems:"center",flexBasis:"40%"},button_wrapper2:{display:"flex",flexDirection:"column",alignItems:"center",flexShrink:1},button_wrapper3:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"auto",justifySelf:"flex-end"},yes_no:{display:"flex",flexDirection:"row"},nools_button:{position:"absolute",bottom:5,padding:5,width:200,backgroundColor:"#999999",borderRadius:5},nools_button_text:{fontSize:18,textAlign:"center"},startstate_button:{position:"relative",width:200,fontSize:18,backgroundColor:"#4CAF50",borderRadius:5,padding:5},startstate_button_text:{fontSize:20,textAlign:"center"},yes_button:{width:80,backgroundColor:"#4CAF50",borderRadius:6,margin:8,padding:4},yes_button_text:{fontSize:30,textAlign:"center"},no_button:{width:80,backgroundColor:"#f44336",borderRadius:6,margin:8,padding:4},no_button_text:{fontSize:30,textAlign:"center"},next_button:{width:100,backgroundColor:"#4CAFFF",borderRadius:6,margin:10,padding:5},next_button_text:{fontSize:35,textAlign:"center"},submit_button:{width:150,backgroundColor:"#4CAFFF",borderRadius:6,margin:10,padding:5},submit_button_text:{fontSize:30,textAlign:"center"},prompt_text:{textAlign:"center",fontSize:25}}),R=I;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=n(121),H=Object(B.a)({initial:"Specify_Start_State",states:{Specify_Start_State:{on:{START_STATE_SET:"Query_Demonstrate"}},Query_Demonstrate:Object(s.a)({on:{DEMONSTRATE:"Request_Foci",DONE:"Specify_Start_State"}},{initial:"Waiting_For_Applicable_Skills",states:{Waiting_For_Applicable_Skills:{entry:["query_apprentice"],on:{APPLICABLE_SKILLS_RECIEVED:"Query_Yes_No_Feedback",NO_SKILLS_RECIEVED:"No_Query_Feedback"}},No_Query_Feedback:{on:{SKILL_PANEL_FEEDBACK_NONEMPTY:"Query_Submit_Feedback"}},Query_Yes_No_Feedback:{on:{SKILL_PANEL_FEEDBACK_NONEMPTY:"Query_Submit_Feedback",YES_PRESSED:"Waiting_For_Applicable_Skills",NO_PRESSED:"Waiting_For_Applicable_Skills"}},Query_Submit_Feedback:{on:{SKILL_PANEL_FEEDBACK_EMPTY:[{target:"Query_Yes_No_Feedback"},{target:"No_Query_Feedback"}],SUBMIT_SKILL_FEEDBACK:"Waiting_For_Applicable_Skills"}}}}),Request_Foci:{on:{FOCI_DONE:"Explantions_Displayed"}},Explantions_Displayed:{on:{NEXT_PRESSED:"Query_Demonstrate",DEMONSTRATE:"Request_Foci",DONE:"Specify_Start_State"}}}},{actions:{query_apprentice:function(e,t){window.query_apprentice()}}}),Q=n(118);function W(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;l.a.render(r.a.createElement(N,{skill_set:e,select_callback:t,correctness_callback:n,initial_select:a,where_colors:o||void 0,current:window.state_machine,service:window.state_machine_service}),document.getElementById("skill_panel"))}function M(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];window.state_machine=e,l.a.render(r.a.createElement(R,{current:e,service:window.state_machine_service,debugmode:t,callbacks:window.button_callbacks,nools_callback:window.nools_callback}),document.getElementById("buttons"))}window.state_machine=H.initialState,window.state_machine_service=Object(Q.a)(H),window.state_machine_service.start(),window.state_machine_service.onTransition(function(e){console.log("current.value"),console.log(e.value),M(e,window.debugmode)}),window.setSkillWindowState=W,window.setButtonCallbacks=W,window.setButtonsState=M;window.debugmode=!1,"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},94:function(e,t,n){e.exports=n(113)},99:function(e,t,n){}},[[94,1,2]]]);
//# sourceMappingURL=main.475ee236.chunk.js.map